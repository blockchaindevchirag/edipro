<div class="modal fade centerAligned" id="cbct_consent_form" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Discussion and Informed Consent for Cone Beam Computerized Tomography</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

            </div>
            <div class="container">
                <div class="card-body">
                    <form id="cbct_form">
                        <div class="row">
                            <div class="col-12">
                                <p>Patient Name:<input type="text" name="cbct01" id="cbct01" class="data_patient_name col-6 dateborder" readonly style="margin-right:2rem;">
                                    Date:<input type="text" name="cbct1" id="cbct1" autocomplete="off" class="dateborder  notfuturedate col-auto"></p>
                                <p>Practice Name:<input type="text" name="cbct8" id="cbct8" readonly class="col-9 dateborder data_practice_name"> </p>
                                <p>Diagnosis:<input type="text" name="cbct2" id="cbct2" class="col-11 col-md-9 col-xl-11 dateborder" style="padding:0" maxlength="80"></p>
                                <P>Treatment:<input type="text" name="cbct3" id="cbct3" class="col-11 col-md-9 col-xl-11 dateborder" style="padding:0" maxlength="80"></p>

                                <h6>Facts for Consideration</h6>
                                <p>Patient's initials required</p>

                                <p>   <canvas id="sign_231ccf1" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf1_clear()" >Clear Signature</a></span>
                                    &ensp;A Cone Beam Computerized Tomography (CBCT) scan, is an X-ray technique that can produce three-
                                    dimensional (3-D) images of your head and allows visualization of internal bony structures in cross
                                    section rather than as overlapping images typically produced by conventional two-dimensional (2-D) X-
                                    ray exams. Dentists use CBCT scans to visualize many areas, including bony structures, such as your teeth
                                    and jaws, but not necessarily soft tissue, such as your tongue or gums.</p>

                                <h6>Benefits of CBCT Scan, Not Limited to the Following:</h6>
                                <p>   <canvas id="sign_231ccf2" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf2_clear()" >Clear Signature</a></span>
                                    &ensp;A conventional X-ray of your mouth limits your dentist to a 2-D (flat) visualization. Some diagnosis and
                                    treatment planning can be aided with a more complete visualization by way of 3-D anatomy. CBCT
                                    scans can provide dentists with 3-D information when planning some treatment such as dental implants,
                                    surgical extractions, maxillofacial surgery and advanced dental restorative procedures.</p>
                                <p>   <canvas id="sign_231ccf3" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf3_clear()" >Clear Signature</a></span>
                                    &ensp;Greater opportunity to diagnose conditions such as vertical root fractures that can be missed on
                                    conventional X-ray films.</p>
                                <p>   <canvas id="sign_231ccf4" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf4_clear()" >Clear Signature</a></span>
                                    &ensp;Greater chance of providing images and information that may allow better evaluation of the necessity of
                                    a particular dental treatment.</p>
                                <p>   <canvas id="sign_231ccf5" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf5_clear()" >Clear Signature</a></span>
                                    &ensp;Potential for improved diagnosis of third molar (wisdom teeth) and other teeth positioning in proximity to
                                    vital structures, such as nerves and blood vessels and sinuses prior to removal.</p>
                                <p>   <canvas id="sign_231ccf6" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf6_clear()" >Clear Signature</a></span>
                                    &ensp;Potential for increased accuracy when planning implant placement surgery.</p>

                                <h6>Risks of CBCT Scan, Not Limited to the Following:</h6>
                                <p>   <canvas id="sign_231ccf7" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf7_clear()" >Clear Signature</a></span>
                                    &ensp;CBCT scans, like conventional X-rays, expose you to radiation. The dose of radiation used for the CBCT
                                    scan is controlled to allow the smallest dose used that will still give sufficient data to achieve a useful
                                    result. The dosage per scan is equivalent to two (2) regular dental X-rays. Scientists have linked radiation
                                    exposure with a slightly higher risk of developing cancer; however, the advantages of the CBCT scan
                                    generally outweigh the risks.</p>
                                <p>   <canvas id="sign_231ccf8" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf8_clear()" >Clear Signature</a></span>
                                    &ensp;X-ray imaging of the mouth is generally not contraindicated in pregnancy and should be utilized as
                                    required to complete a full examination, diagnosis and treatment plan. Please advise your dentist if you
                                    are pregnant or planning to become pregnant so that your dentist can make the best determination of the
                                    types of radiographs needed to ensure you receive the lowest amount of reasonably achievable radiationfor your dental treatment needs and can discuss whether the benefits of the scan outweigh the risks.
                                    Discuss concerns specific to X-rays during pregnancy with your physician.</p>
                                <p>   <canvas id="sign_231ccf9" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf9_clear()" >Clear Signature</a></span>
                                    &ensp; The CBCT scan may or may not reveal coincidental medical findings unrelated to your dental condition,
                                    dental care and dental treatment. A CBCT scan is a diagnostic procedure intended solely to facilitate
                                    diagnosis of your dental condition and your dental care and to help plan your dental treatment. The
                                    CBCT scan will be evaluated solely for the purposes associated with the dental procedures discussed in
                                    your treatment plan. The data obtained during this study may result in incidental findings unrelated to
                                    your dental condition, dental care and dental treatment and are beyond the scope and purpose of your
                                    dental condition. Your dentist is not a physician or a specialist qualified to make the assessment
                                    concerning anatomy and pathology beyond your mouth and jaw. As a result, you may elect to have the
                                    CBCT scan data evaluated by a physician or dental and or medical radiologist.</p>

                                <h6>Alternatives to CBCT Scan, Not Limited to the Following:</h6>
                                <p>   <canvas id="sign_231ccf10" width="100" height="40"></canvas>
                                    <span style="position: absolute; color: red"><a onclick="sign_231ccf10_clear()" >Clear Signature</a></span>
                                    &ensp;An alternative to CBCT scans are conventional X-rays; however, they have limitations. Conventional X-
                                    rays of your mouth and jaws limit your dentist to evaluating anatomical structures in a two-dimensional
                                    view. A more complete understanding of complex 3-D anatomy can enhance your diagnosis and
                                    treatment planning. The relationship of anatomical structures in three dimensions is important in assessing
                                    your condition as well as treatment planning for dental implants, surgical extractions, endodontic
                                    treatment, oral surgery or advanced dental restorative procedures. CBCT scans may be useful in
                                    evaluating and potentially diagnosing conditions that cannot be fully appreciated with conventional X-
                                    rays. The use of CBCT should be a decision between you and your dentist.</p>

                                <h6>Check the boxes below that apply to you:</h6>
                                <h6>Consent</h6>

                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check" class="custom-control-input input-primary cbctcf_chk" id="ccf1" value="CBCTCONSENT">
                                    <label class="custom-control-label" for="ccf1">I have been informed both verbally and by the information provided on this form of the risks and benefits of the
                                        proposed CBCT scan as described above.</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check1" class="custom-control-input input-primary cbctcf_chk" id="ccf2" value="CBCTCONSENT1">
                                    <label class="custom-control-label" for="ccf2">I have been informed both verbally and by the information provided on this form of the material risks and
                                        benefits of alternative X-rays and of electing not to have the scan performed.</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check2" class="custom-control-input input-primary cbctcf_chk" id="ccf3" value="CBCTCONSENT2">
                                    <label class="custom-control-label" for="ccf3">I certify that I have read and understand the above information and that the explanations referred to are
                                        understood by me, that my questions have been answered and that the blanks requiring insertions or completion
                                        have been filled in. I authorize and direct Dr.<input type="text" name="cbct4" id="cbct4" class="col-5 dateborder" style="padding:0" maxlength="60">to do whatever he/she deems
                                        necessary and advisable under the circumstances.</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check3" class="custom-control-input input-primary cbctcf_chk" id="ccf4" value="CBCTCONSENT3">
                                    <label class="custom-control-label" for="ccf4">I consent to have the above-mentioned CBCT scan.</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check4" class="custom-control-input input-primary cbctcf_chk" id="ccf5" value="CBCTCONSENT4">
                                    <label class="custom-control-label" for="ccf5">
                                        While the scan may be covered by my medical and/or dental insurance, I accept any financial responsibility
                                        for this scan and authorize the scan.</label>
                                </div>
                                <h6>or</h6>
                                <h6>Refusal</h6>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="cbct_check5" class="custom-control-input input-primary refusal_cbct" id="ccf6" value="CBCTCONSENT5">
                                    <label class="custom-control-label" for="ccf6">
                                        I refuse to give my consent for the proposed CBCT scan described above and understand the potential
                                        consequences associated with this refusal. <span style="font-weight: bold">Note:</span> Failure to have a CBCT scan may result in failure to detect or
                                        diagnose significant disease and associated potential harm.</label>
                                </div>
                                <div class="row">
                                    <div class="col-8 col-xl-6 col-md-8">
                                        <div class="row">
                                            <div class="col-12">
                                                <canvas id="sign_231ccf13" width="480" height="80" class="col-12"></canvas>
                                            </div>
                                        </div>
                                        <p>Patient or Patient's Representative Signature 
                                            <span class="d-none d-md-inline-block"  style="color: red;margin-left: 20px;"><a onclick="sign_231ccf13_clear()">Clear Signature</a></span>
                                            <span class="d-inline-block  d-md-none"  style="color: red;margin-left: 20px;"><a onclick="sign_231ccf13_clear()">Clear</a></span>
                                        </p>
                                    </div>
                                    <div class="col-4" style="margin-top: 15px;">

                                        <input type="text" name="cbct6" id="cbct6" autocomplete="off" class=" notfuturedate col-auto dateborder" style="padding:0">

                                        <p>Date</p>
                                    </div>
<!---------------------------------------------------------------->                                    
                                    <div class="col-8 col-xl-6 col-md-8">
                                        <div class="row">
                                            <div class="col-12">
                                               <canvas id="sign_231ccf11" width="480" height="80" class="col-12"></canvas>
                                            </div>
                                        </div>
                                        <p>Witness Signature <span style="color: red;margin: 20px;"><a onclick="sign_231ccf11_clear()">Clear Signature</a></span> </p>
                                    </div>
                                    <div class="col-4" style="margin-top: 15px;">

                                        <input type="text" name="cbctSign1" autocomplete="off"  id="cbctSign1" class="col-auto dateborder  notfuturedate" style="padding:0">   

                                        <p>Date</p>
                                    </div>
<p class="col-12">I attest that I have discussed the risks, benefits, consequences and alternatives of the above treatment with <input type="text" name="cbct7" id="cbct7" class="col-5 dateborder" style="padding:0" maxlength="60"> (Patient or Patient's Representative) and they have had the opportunity to ask questions. I believe they understand what has been explained and consents or refuses treatment CBCT.</p>
<!----------------------------------------------------------------------------->
                                    <div class="col-8 col-xl-6 col-md-8">
                                        <div class="row">
                                            <div class="col-12">
                                               <canvas id="sign_231ccf12" width="480" height="80" class="col-12"></canvas>
                                            </div>
                                        </div>
                                        <p>Dentist Signature <span style="color: red;margin: 20px;"><a onclick="sign_231ccf12_clear()">Clear Signature</a></span></p>
                                    </div>
                                    <div class="col-4" style="margin-top: 15px; margin-bottom: 131px">

                                        <input type="text" name="cbctSign2"  id="cbctSign2" autocomplete="off" class="col-auto dateborder  notfuturedate" style="padding:0">   

                                        <p>Date</p>
                                    </div>
<!----------------------------------------------------------------------------->
                                      
                                </div>            
                            </div>            
                        </div>
                    </form>
                </div>  
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="buttonid" onclick="cbctSave(this)">Submit</button>
            </div>
        </div>
    </div>
</div>
 
<script>

                    function cbctSave(buttonObj)
                    {
                         if(!$('#cbct1').val())
                        {
                             msgbox("Date is Mandatory", "Patient Checklist", "error");
                              return false;
                        }
                        $(buttonObj).attr('disabled', 'disabled');
                        $(buttonObj).text('Sending...');

                        $(buttonObj).off('click'); //disables click event

                        var sign_cbct = window.sign_231ccf1.toDataURL("image/png");
                        var sign_cbct1 = sign_cbct.replace('data:image/png;base64,', '');

                        var sign_cbct2 = window.sign_231ccf2.toDataURL("image/png");
                        var sign_cbct_2 = sign_cbct2.replace('data:image/png;base64,', '');

                        var sign_cbct3 = window.sign_231ccf3.toDataURL("image/png");
                        var sign_cbct_3 = sign_cbct3.replace('data:image/png;base64,', '');

                        var sign_cbct4 = window.sign_231ccf4.toDataURL("image/png");
                        var sign_cbct_4 = sign_cbct4.replace('data:image/png;base64,', '');

                        var sign_cbct5 = window.sign_231ccf5.toDataURL("image/png");
                        var sign_cbct_5 = sign_cbct5.replace('data:image/png;base64,', '');

                        var sign_cbct6 = window.sign_231ccf6.toDataURL("image/png");
                        var sign_cbct_6 = sign_cbct6.replace('data:image/png;base64,', '');

                        var sign_cbct7 = window.sign_231ccf7.toDataURL("image/png");
                        var sign_cbct_7 = sign_cbct7.replace('data:image/png;base64,', '');

                        var sign_cbct8 = window.sign_231ccf8.toDataURL("image/png");
                        var sign_cbct_8 = sign_cbct8.replace('data:image/png;base64,', '');

                        var sign_cbct9 = window.sign_231ccf9.toDataURL("image/png");
                        var sign_cbct_9 = sign_cbct9.replace('data:image/png;base64,', '');

                        var sign_cbct10 = window.sign_231ccf10.toDataURL("image/png");
                        var sign_cbct_10 = sign_cbct10.replace('data:image/png;base64,', '');

                        var sign_cbct11 = window.sign_231ccf11.toDataURL("image/png");
                        var sign_cbct_11 = sign_cbct11.replace('data:image/png;base64,', '');

                        var sign_cbct12 = window.sign_231ccf12.toDataURL("image/png");
                        var sign_cbct_12 = sign_cbct12.replace('data:image/png;base64,', '');

                        var sign_cbct13 = window.sign_231ccf13.toDataURL("image/png");
                        var sign_cbct_13 = sign_cbct13.replace('data:image/png;base64,', '');

                        let checkboxes = document.querySelectorAll('input[name="cbct_check"]:checked');
                        let values = [];
                        checkboxes.forEach((checkbox) => {
                            values.push(checkbox.value);
                        });

                        let checkboxes1 = document.querySelectorAll('input[name="cbct_check1"]:checked');
                        let values1 = [];
                        checkboxes1.forEach((checkbox) => {
                            values1.push(checkbox.value);
                        });

                        let checkboxes2 = document.querySelectorAll('input[name="cbct_check2"]:checked');
                        let values2 = [];
                        checkboxes2.forEach((checkbox) => {
                            values2.push(checkbox.value);
                        });

                        let checkboxes3 = document.querySelectorAll('input[name="cbct_check3"]:checked');
                        let values3 = [];
                        checkboxes3.forEach((checkbox) => {
                            values3.push(checkbox.value);
                        });

                        let checkboxes4 = document.querySelectorAll('input[name="cbct_check4"]:checked');
                        let values4 = [];
                        checkboxes4.forEach((checkbox) => {
                            values4.push(checkbox.value);
                        });

                        let checkboxes5 = document.querySelectorAll('input[name="cbct_check5"]:checked');
                        let values5 = [];
                        checkboxes5.forEach((checkbox) => {
                            values5.push(checkbox.value);
                        });

                        var patientname = $('#cbct01').val();
                        var currentdate = $('#cbct1').val();
                        var patientdiagnosis = $('#cbct2').val();
                        var patienttreatment = $('#cbct3').val();
                        var patienttxt1 = $('#cbct4').val();
                        var signdate1 = $('#cbct6').val();
                        var signdate2 = $('#cbctSign1').val();
                        var patienttxt2 = $('#cbct7').val();
                        var signdate3 = $('#cbctSign2').val();
                        
                        $.ajax({
                            url: "generatecbctpdf",
                            type: "POST", //send it through get method
                            data: {
                                patientid: $("#patientCombo option:selected").val(),
                                patientname: patientname,
                                currentdate : currentdate,
                                patientdiagnosis : patientdiagnosis,
                                patienttreatment : patienttreatment,
                                lastname: $("#inputLastName").val(),
                                firstname: $("#inputFirstName").val(),
                                patientsignature1 : sign_cbct1,
                                patientsignature2 : sign_cbct_2,
                                patientsignature3 : sign_cbct_3,
                                patientsignature4 : sign_cbct_4,
                                patientsignature5 : sign_cbct_5,
                                patientsignature6 : sign_cbct_6,
                                patientsignature7 : sign_cbct_7,
                                patientsignature8 : sign_cbct_8,
                                patientsignature9 : sign_cbct_9,
                                patientsignature10 : sign_cbct_10,
                                patientcheckbox1 : values,
                                patientcheckbox2 : values1,
                                patientcheckbox3 : values2,
                                patienttxt1 : patienttxt1,
                                patientcheckbox4 : values3,
                                patientcheckbox5 : values4,
                                patientcheckbox6 : values5,
                                patientsignature : sign_cbct_11,
                                signdate1 : signdate1,
                                witnesssignature :sign_cbct_12,
                                signdate2 : signdate2,
                                patienttxt2 : patienttxt2,
                                dentistsignature :sign_cbct_13,
                                signdate3 : signdate3
                            },
                            success: function (response) {
                                if (response.length > 0)
                                {
                                    $("#cbct_consent_form").modal('hide');
                                    $('#patientCombo').trigger('change');
                                }
                                $(buttonObj).removeAttr('disabled');
                                $(buttonObj).text('Submit');
                            },
                            error: function (err) {
                                console.log(err);
                                $(buttonObj).removeAttr('disabled');
                                $(buttonObj).text('Submit');
                            }
                        });
                    }

//========signature==========================
                    $(document).ready(function () {
                        window.sign_231ccf1 = new SignaturePad($('#sign_231ccf1').get(0), {});
                        window.sign_231ccf2 = new SignaturePad($('#sign_231ccf2').get(0), {});
                        window.sign_231ccf3 = new SignaturePad($('#sign_231ccf3').get(0), {});
                        window.sign_231ccf4 = new SignaturePad($('#sign_231ccf4').get(0), {});
                        window.sign_231ccf5 = new SignaturePad($('#sign_231ccf5').get(0), {});
                        window.sign_231ccf6 = new SignaturePad($('#sign_231ccf6').get(0), {});
                        window.sign_231ccf7 = new SignaturePad($('#sign_231ccf7').get(0), {});
                        window.sign_231ccf8 = new SignaturePad($('#sign_231ccf8').get(0), {});
                        window.sign_231ccf9 = new SignaturePad($('#sign_231ccf9').get(0), {});
                        window.sign_231ccf10 = new SignaturePad($('#sign_231ccf10').get(0), {});
                        window.sign_231ccf11 = new SignaturePad($('#sign_231ccf11').get(0), {});
                        window.sign_231ccf12 = new SignaturePad($('#sign_231ccf12').get(0), {});
                        window.sign_231ccf13 = new SignaturePad($('#sign_231ccf13').get(0), {});

//---------------------------refusal checkbox----------------------
                        $('.cbctcf_chk').change(function () {
                            (!$(this).is(':checked')) ? $('.refusal_cbct').prop('disabled', false) : $('.refusal_cbct').prop('disabled', true);
                        });

                        $('.refusal_cbct').change(function () {
                            (!$(this).is(':checked')) ? $('.cbctcf_chk').prop('disabled', false) : $('.cbctcf_chk').prop('disabled', true);
                        });
//-------------------------------------------------------------     
                    });

                    var sign_231ccf1_clear = function () {
                        window.sign_231ccf1.clear();
                    };
                    var sign_231ccf2_clear = function () {
                        window.sign_231ccf2.clear();
                    };
                    var sign_231ccf3_clear = function () {
                        window.sign_231ccf3.clear();
                    };
                    var sign_231ccf4_clear = function () {
                        window.sign_231ccf4.clear();
                    };
                    var sign_231ccf5_clear = function () {
                        window.sign_231ccf5.clear();
                    };
                    var sign_231ccf6_clear = function () {
                        window.sign_231ccf6.clear();
                    };
                    var sign_231ccf7_clear = function () {
                        window.sign_231ccf7.clear();
                    };
                    var sign_231ccf8_clear = function () {
                        window.sign_231ccf8.clear();
                    };
                    var sign_231ccf9_clear = function () {
                        window.sign_231ccf9.clear();
                    };
                    var sign_231ccf10_clear = function () {
                        window.sign_231ccf10.clear();
                    };
                    var sign_231ccf11_clear = function () {
                        window.sign_231ccf11.clear();
                    };
                    var sign_231ccf12_clear = function () {
                        window.sign_231ccf12.clear();
                    };
                    var sign_231ccf13_clear = function () {
                        window.sign_231ccf13.clear();
                    };

</script>