<div class="modal fade centerAligned" id="Fixation_Screw" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">
                    DISCUSSION AND INFORMED CONSENT FOR TITANIUM BONE STABILIZER SCREW   
                </h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

            </div>
            <div class="container">
                <div class="card-body">          
                    <p>Patient Name:<input type="text" name="fix1" id="fix1" class="data_patient_name col-7 col-xl-7 col-md-7 inputborder"> 
                        Date: <input type="text" name="fix2" id="fix2" autocomplete="off"  class=" notfuturedate col-auto dateborder"> </p>
                     <p>Practice Name:<input type="text" name="fix14" id="fix14" readonly class="col-9 dateborder data_practice_name"> </p>
                    <p>Diagnosis:<input type="text" name="fix3" id="fix3" class="col-11 col-xl-11 col-md-10 inputborder"   maxlength="90"></p>
                    <p>Treatment & Tooth Number(s): <input type="text"name="fix4" id="fix4" class="col-10 col-xl-10 col-md-8 inputborder"  maxlength="72"></p>
                    <h6>Facts for Consideration <br></h6>
                    <div class="row">
                        <div class="col-12">
                            <h6> What Are Implants?  <br></h6>
                            <p>Bone Stabilizer Screws differ to stabilize from the bone graft to fixed the bone defect, bone lesion, bone 
                                infection, tuberculous of bone, fracture of alveolar bone or bone atrophy alveolar thin bridge.  </p>
                            <p>
                                The Bone Stabilizer Screws are placed surgically. Usually under local anesthetic or general anesthesia or IV
                                sedation, the gum tissue is reflected, precise drilling of holes in the jawbone is performed to accommodate
                                the screws (cylindrical metal posts) which are immediately placed in them. The surgical site is then closed.
                                The second surgical procedure occurs three to eight months later. The Bone Stabilizer Screws are then
                                evaluated for healing and successful integration with the bone. Some revisions may have to be made at this
                                time. If the screw failed to integrate, it will have to be removed and alternative treatments considered, such
                                as a change of the site or titanium screw. If the Bone Stabilizer Screw has successfully integrated, extending 
                                through the gum tissue into the mouth. In the final prosthetic phase, a metal sleeve is threaded into the
                                screw to anchor the prosthetic appliance, crown or bridge. The prosthetic appliance or plate fee is separate 
                                from the surgical fee.
                            </p>
                        </div>
                        <div class='col-12' style='text-align:right;margin-bottom: 15px'>
                            (Initials )&ensp;<canvas Initials id="sign_236fs01" width="150" height="50">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs1_clear()"><br>Clear Signature</a></span>
                        </div>
<!--                        <div class="row" >
                            <div class="col-6">
                                Initials<canvas Initials id="sign_236fs01" width="100" height="40" class="col-12">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs1_clear()">Clear Signature</a></span>
                                </div>
                            </div>-->
                        <!--=====================================================================-->                
                        <div class="col-12">
                            <h6> Alternatives to Implants  <br></h6>
                            <p>As implied above, alternatives to screws replacement may be fixed bone or tissue defect, removable
                                partial and complete prosthetic plate or appliance. Infected bone with sound jawbone and bone support
                                may be treated with laser therapy.. </p>                    
                        </div>
                        <div class='col-12' style='text-align:right;margin-bottom: 15px'>
                          ( Initials) &ensp;<canvas Initials id="sign_236fs02" width="150" height="50">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs2_clear()"><br> Clear Signature</a></span>
                                </div>
                     
                        <!--=====================================================================-->                
                        <div class="col-12">
                            <h6>Risks <br></h6>
                            <p>Surgical risks include, but are not limited to: post-surgical infection; bleeding; swelling; pain; facial 
                                discoloration; sinus or nasal perforation; TMJ injuries; spasms; bone fracture; poor healing; numbness 
                                (paresthesia) of the lip, chin and tongue, which is usually temporary, but, on occasion, may be permanent.</p>
                            <p>
                                The prosthetic risks include but are not limited to: unsuccessful integration of the screw(s) to stablelize the 
                                bone; fracture of the post-osseointegration mechanical screw components. If a separate surgical procedure 
                                is necessary to remove a failed screw(s) or if a replacement is necessary due to changed prosthetic 
                                requirements, an additional fee may be charged.
                            </p>
                        </div>
                        <div class='col-12' style='text-align:right;margin-bottom: 15px'>
                            ( Initials )&ensp;<canvas Initials id="sign_236fs03" width="150" height="50">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs3_clear()"><br> Clear Signature</a></span>
                                </div>
                        
                        <!--=====================================================================-->                
                        <div class="col-12">
                            <h6>Unanticipated Conditions <br></h6>
                            <p>During the course of treatment, unknown oral conditions may modify or change the original treatment plan. 
                                This possibility necessitates consent for the treating doctor, in consultation with the patient, if possible, to 
                                use the best judgment in consideration of the new found conditions.</p>

                        </div>
                         <div class='col-12' style='text-align:right;margin-bottom: 15px'>
                            (Initials) &ensp;<canvas Initials id="sign_236fs04" width="150" height="50">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs4_clear()"><br> Clear Signature</a></span>
                                </div>
                       
                        <!--=====================================================================-->                
                        <div class="col-12">
                            <h6>Summary <br/></h6>
                            <p>You have been provided a general overview of Bone Stabilizer Screws. Titanium screws have about an 
                                85% success rate with various factors influencing the outcome. The benefits, as well as the risks, have 
                                been discussed. The alternatives to titanium screw replacement have also been discussed, as well as 
                                the consequence of non-replacement. No discussion or form can be all inclusive and you are 
                                encouraged to ask questions regarding any concerns or needed clarifications, to enable you to make 
                                an informed decision. Dentistry is not an exact science. Every individual is unique and guarantees of 
                                success cannot be made</p>

                        </div>
                        <div class='col-12' style='text-align:right;margin-bottom: 15px'>
                           (Initials)&ensp;<canvas Initials id="sign_236fs05" width="150" height="50">		 			
                                    </canvas>
                                <span style="color: red;margin: 20px;"><a onclick="sign_236fs5_clear()"><br> Clear Signature</a></span>
                                </div>
                        
                        <!------------============================================================---------------------------->
                        <div class="col-12">
                            <h6>Check the boxes below that apply to you:</h6>
                            <h6>Consent</h6>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="fixation" class="fixscrew_chk custom-control-input input-primary" id="fs1" value="fixationscrew1">
                                <label class="custom-control-label" for="fs1">I have been informed both verbally and by the information provided on this form of the risks and
                                    benefits of the proposed treatment.</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="fixation1"class="fixscrew_chk custom-control-input input-primary" id="fs2" value="fixationscrew2">
                                <label class="custom-control-label" for="fs2">
                                    I have been informed both verbally and by the information provided on this form of the material risks
                                    and benefits of alternative treatment and of electing not to treat my condition.
                                </label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="fixation2"class="fixscrew_chk custom-control-input input-primary" id="fs3" value="fixationscrew3">
                                <label class="custom-control-label" for="fs3">
                                    I certify that I have read and understand the above information and that the explanations referred to
                                    are understood by me, that my questions have been answered and that the blanks requiring insertions
                                    or completion have been filled in. I authorize and direct Dr.- <input type="text" name="fix10" id="fix10" class="fixscrew_chk col-5 dateborder"   maxlength="65"  style="padding:0">to do whatever he/she
                                    deems necessary and advisable under the circumstances
                                </label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="fixation3"class="fixscrew_chk custom-control-input input-primary" id="fs4" value="fixationscrew4">
                                <label class="custom-control-label" for="fs4">
                                    I consent to have the above-mentioned treatment. 
                                </label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="fixation4" class="fixscrew_chk custom-control-input input-primary" id="fs5" value="fixationscrew5">
                                <label class="custom-control-label" for="fs5">
                                    While the treatment may be covered by my medical and/or dental insurance, I accept any financial
                                    responsibility for this treatment and authorize treatment
                                </label>
                            </div>

                            <h6 style='margin-top: 15px'>or</h6>
                            <h6 style='margin-bottom: 15px;'>Refusal</h6>
                            <div class="custom-control custom-checkbox" style='margin-bottom: 20px;'>
                                <input type="checkbox" name="fixation5"class="fixscrewrefusal_chk custom-control-input input-primary" id="fs6" value="fixationscrew6">
                                <label class="custom-control-label" for="fs6">
                                    I refuse to give my consent for the proposed treatment(s) described above and understand the
                                    potential consequences associated with this refusal
                                </label>
                            </div>
                        </div>


                        <!--==============================================================================================-->
                        <div class="col-7">
                            <div class="row">
                                <div class="col-12">
                                    <canvas id="sign_236fs06" width="480" height="80" class="col-12">		 			
                                    </canvas>
                                </div>
                            </div>
                            <p>Patient or Patient's Representative Signature <span style="color: red;margin: 20px;"><a onclick="sign_236fs6_clear()">Clear Signature</a></span></p>
                        </div>
                        <div class="col-4" style="display: flex;align-items: flex-end;height: 75px;">
                            Date:<input type="text" name="fix11" id="fix11" autocomplete="off"  class=" notfuturedate col-auto dateborder" style="padding:0">   
                        </div>


                        <!--======================= Witness Signature======================-->
                        <div class="col-7">
                            <div class="row">
                                <div class="col-12">
                                    <canvas id="sign_236fs07" width="480" height="80" class="col-12">		 			
                                    </canvas>
                                </div>
                            </div>
                            <p>Witness Signature <span style="color: red;margin: 20px;"><a onclick="sign_236fs7_clear()">Clear Signature</a></span></p>
                        </div>
                        <div class="col-4" style="display: flex;align-items: flex-end; height: 75px; margin-bottom: 131px">
                            Date:<input type="text" name="fix12" id="fix12" autocomplete="off" class=" notfuturedate col-auto dateborder" style="padding:0">   
                        </div>

                        <!-------------------------------------------------->
                        <div class="col-12">
                            <p>I attest that I have discussed the risks, benefits, consequences and alternatives of the above treatment 
                                will<input type="text" name="fix13" id="fix13" class="col-5 dateborder"  maxlength="65">  (Patient or Patient's Representative) and they have had the 
                                opportunity to ask questions. I believe they understand what has been explained and consents or refuses 
                                treatment noted above</p>   
                        </div>

                    </div>
                </div>     
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary"  onclick="fixationscrew_btn(this)">Submit</button>
            </div>
        </div>
    </div>
</div>


<script>

    function fixationscrew_btn(buttonObj)
    {
        if(!$('#fix2').val())
           {
            msgbox("Date is Mandatory", "Patient Checklist", "error");
            return false;
           }
        $(buttonObj).attr('disabled', 'disabled');
        $(buttonObj).text('Sending...');

        $(buttonObj).off('click'); //disables click event
        var sign_236fs1 = window.sign_236fs1.toDataURL("image/png");
        var sign_236fs1_1 = sign_236fs1.replace('data:image/png;base64,', '');

        var sign_236fs2 = window.sign_236fs2.toDataURL("image/png");
        var sign_236fs2_2 = sign_236fs2.replace('data:image/png;base64,', '');
        
        var sign_236fs3 = window.sign_236fs3.toDataURL("image/png");
        var sign_236fs3_3 = sign_236fs3.replace('data:image/png;base64,', '');
        
        var sign_236fs4 = window.sign_236fs4.toDataURL("image/png");
        var sign_236fs4_4 = sign_236fs2.replace('data:image/png;base64,', '');
        
        var sign_236fs5 = window.sign_236fs5.toDataURL("image/png");
        var sign_236fs5_5 = sign_236fs5.replace('data:image/png;base64,', '');
        
        var sign_236fs6 = window.sign_236fs6.toDataURL("image/png");
        var sign_236fs6_6 = sign_236fs6.replace('data:image/png;base64,', '');
        
        var sign_236fs7 = window.sign_236fs7.toDataURL("image/png");
        var sign_236fs7_7 = sign_236fs7.replace('data:image/png;base64,', '');
        


        let checkboxes = document.querySelectorAll('input[name="fixation"]:checked');
        let values = [];
        checkboxes.forEach((checkbox) => {
            values.push(checkbox.value);
        });
        //alert(values);

        let checkboxes1 = document.querySelectorAll('input[name="fixation1"]:checked');
        let values1 = [];
        checkboxes1.forEach((checkbox) => {
            values1.push(checkbox.value);
        });
        //alert(values1);

        let checkboxes2 = document.querySelectorAll('input[name="fixation2"]:checked');
        let values2 = [];
        checkboxes2.forEach((checkbox) => {
            values2.push(checkbox.value);
        });
        //alert(values2);

        let checkboxes3 = document.querySelectorAll('input[name="fixation3"]:checked');
        let values3 = [];
        checkboxes3.forEach((checkbox) => {
            values3.push(checkbox.value);
        });
        // alert(values3);

        let checkboxes4 = document.querySelectorAll('input[name="fixation4"]:checked');
        let values4 = [];
        checkboxes4.forEach((checkbox) => {
            values4.push(checkbox.value);
        });
        //alert(values4);

        let checkboxes5 = document.querySelectorAll('input[name="fixation5"]:checked');
        let values5 = [];
        checkboxes5.forEach((checkbox) => {
            values5.push(checkbox.value);
        });
        //alert(values5);

        
        var patientname= $('#fix1').val();
        var patientcurrentdate = $('#fix2').val();
        var patientdiagnosis = $('#fix3').val();
        var patienttreatment = $('#fix4').val();
        var patienttxt1 = $('#fix10').val();
        var signdate1 = $('#fix11').val();
        var signdate2 = $('#fix12').val();
        var patienttxt2= $('#fix13').val();
        

        $.ajax({
            url: "generatefixationpdf",
            type: "POST", //send it through get method
            data: {
                
                patientname: patientname,
                patientcurrentdate : patientcurrentdate,
                patientid: $("#patientCombo option:selected").val(),
                patientdiagnosis: patientdiagnosis,
                patienttreatment: patienttreatment,
                patientsignature1: sign_236fs1_1,
                patientlastname: $("#inputLastName").val(),
                patientfirstname: $("#inputFirstName").val(),
                patientsignature2: sign_236fs2_2,
                patientsignature3: sign_236fs3_3,
                patientsignature4: sign_236fs4_4,
                patientsignature5: sign_236fs5_5,
                patientcheckbox1: values,
                patientcheckbox2: values1,
                patientcheckbox3: values2,
                patienttxt1: patienttxt1,
                patientcheckbox4: values3,
                patientcheckbox5: values4,
                patientcheckbox6: values5,
                patientsignature: sign_236fs6_6,
                signdate1: signdate1,
                witnesssignature: sign_236fs7_7,
                signdate2: signdate2,
                patienttxt2: patienttxt2
                        
            },
            success: function (response) {
                if (response.length > 0)
                { 
                    $("#Fixation_Screw").modal('hide');
                    $('#patientCombo').trigger('change');
                }
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            },
            error: function (err) {
                console.log(err);
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            }

        });

    }

    $(document).ready(function () {
        window.sign_236fs1 = new SignaturePad($('#sign_236fs01').get(0), {});
        window.sign_236fs2 = new SignaturePad($('#sign_236fs02').get(0), {});
        window.sign_236fs3 = new SignaturePad($('#sign_236fs03').get(0), {});
        window.sign_236fs4 = new SignaturePad($('#sign_236fs04').get(0), {});
        window.sign_236fs5 = new SignaturePad($('#sign_236fs05').get(0), {});
        window.sign_236fs6 = new SignaturePad($('#sign_236fs06').get(0), {});
        window.sign_236fs7 = new SignaturePad($('#sign_236fs07').get(0), {});

        //---------------------------refusal checkbox----------------------
        $('.fixscrew_chk').change(function () {
            (!$(this).is(':checked')) ? $('.fixscrewrefusal_chk').prop('disabled', false) : $('.fixscrewrefusal_chk').prop('disabled', true);
        });

        $('.fixscrewrefusal_chk').change(function () {
            (!$(this).is(':checked')) ? $('.fixscrew_chk').prop('disabled', false) : $('.fixscrew_chk').prop('disabled', true);
        });
//-------------------------------------------------------------  

    });
    var sign_236fs1_clear = function () {
        window.sign_236fs1.clear()
    }
    var sign_236fs2_clear = function () {
        window.sign_236fs2.clear()
    }
    var sign_236fs3_clear = function () {
        window.sign_236fs3.clear()
    }
    var sign_236fs4_clear = function () {
        window.sign_236fs4.clear()
    }
    var sign_236fs5_clear = function () {
        window.sign_236fs5.clear()
    }
    var sign_236fs6_clear = function () {
        window.sign_236fs6.clear()
    }
    var sign_236fs7_clear = function () {
        window.sign_236fs7.clear()
    }
    




</script>