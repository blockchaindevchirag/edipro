<div class="modal fade centerAligned" id="FamilyCarePhysicianReferralLette" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">

                </h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

            </div>
            <div class="container">
                <div class="card-body">
                    <form id="form_ref">
                        <div class="row">
                            <div class="col-6 col-xl-6 col-md-auto offset-8" style="margin-left: 50%;margin-bottom: 15px;" >
                                <table class="table-responsive">
                                    <tbody>
                                        <tr>
                                            <td>Refer Physician:</td>
                                            <td><input type="text" name="familycar6_1" id="familycar6_1" class="col-12 col-md-8 dateborder" style="width: 390px" maxlength="60"></td>
                                        </tr>
                                        <tr>
                                            <td>Office address:</td>
                                            <td><input type="text" name="familycar_2" id="familycar_2" class="col-12 col-md-8 dateborder" maxlength="60"></td>
                                        </tr>
                                        <tr>
                                            <td>City, State, Zip:</td>
                                            <td><input type="text" name="familycar_3" id="familycar_3" class="col-12 col-md-8 dateborder" maxlength="60"></td>
                                        </tr>
                                        <tr>
                                            <td>License:</td>
                                            <td><input type="text" name="familycar_4" id="familycar_4" class="col-12 col-md-8 dateborder" maxlength="60"></td>
                                        </tr>
                                        <tr>
                                            <td>Indv. NPI:</td>
                                            <td><input type="text" name="familycar_5" id="familycar_5" class="col-12 col-md-8 dateborder" maxlength="60"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="col-12">
                                <h6 style="text-align: center">REFERAL LETTER</h6>
                                <div class="row">
                                    <div class="col-12">
                                        <table class="table-responsive" style="width: 100%">
                                            <tbody>
                                                <tr>
                                                    <td>Practice Name: </td>
                                                    <td style="width: 401px"> <input type="text" name="familycar_14" id="familycar_14" readonly class="col-12 dateborder data_practice_name"></td>
                                                </tr>
                                                <tr>
                                                    <td>Date:</td>
                                                    <td><input type="text" name="familycar_6" id="familycar_6" autocomplete="off" class=" notfuturedate col-10 dateborder"></td>
                                                </tr>
                                                <tr>
                                                    <td>Physician:</td>
                                                    <td><input type="text" name="familycar_7" id="familycar_7" class="col-12 dateborder" maxlength="60"></td>
                                                </tr>
                                                <tr>
                                                    <td>Address:</td>
                                                    <td><input type="text" name="familycar_8" id="familycar_8" class="col-12 dateborder" maxlength="60"></td>
                                                </tr>
                                                <tr>
                                                    <td>City, State, Zip:</td>
                                                    <td><input type="text" name="familycar_9" id="familycar_9" class="col-12 dateborder" maxlength="60"></td>
                                                </tr>
                                                <tr>
                                                    <td>Dear Dr.:</td>
                                                    <td><input type="text" name="familycar_10" id="familycar_10" class="col-12 dateborder"maxlength="60"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p style="margin-top: 15px;">I have seen our mutual patient <input type="text" name="familycar_11" id="familycar_11" class="col-4 data_patient_name dateborder">. He/She chief complains about problem in his/her mouth region.</p>
                                    </div>                            
                                    <div class="col-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary"name="familynm_1" id="fcpr_1" value="fprl_1">
                                            <label class="custom-control-label" for="fcpr_1">Jaw pain</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary"name="familynm_2" id="fcpr_2" value="fprl_2">
                                            <label class="custom-control-label" for="fcpr_2">Oral Surgery</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary"name="familynm_3" id="fcpr_3" value="fprl_3">
                                            <label class="custom-control-label" for="fcpr_3">Severe pain</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary"name="familynm_4" id="fcpr_4" value="fprl_4">
                                            <label class="custom-control-label" for="fcpr_4">Broken Tooth</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary"name="familynm_5" id="fcpr_5" value="fprl_5">
                                            <label class="custom-control-label" for="fcpr_5">Infection/Abscess</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_6" id="fcpr_6" value="fprl_6">
                                            <label class="custom-control-label" for="fcpr_6">Accident/felt & hit on mouth</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_7" id="fcpr_7" value="fprl_7">
                                            <label class="custom-control-label" for="fcpr_7">Hearing Problem </label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_8" id="fcpr_8" value="fprl_8">
                                            <label class="custom-control-label" for="fcpr_8">Allergy </label>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_9" id="fcpr_9" value="fprl_9">
                                            <label class="custom-control-label" for="fcpr_9">Sensitive drink Hot/Cold water</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_10" id="fcpr_10" value="fprl_10">
                                            <label class="custom-control-label" for="fcpr_10">Bleeding when brush teeth</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input 1nput-primary" name="familynm_11" id="fcpr_11" value="fprl_11">
                                            <label class="custom-control-label" for="fcpr_11">Chronic Fatigue</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_12" id="fcpr_12" value="fprl_12">
                                            <label class="custom-control-label" for="fcpr_12">Tiredness; Lack of Energy</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_13" id="fcpr_13" value="fprl_13">
                                            <label class="custom-control-label" for="fcpr_13">Grinding teeth</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_14" id="fcpr_14" value="fprl_14">
                                            <label class="custom-control-label" for="fcpr_14">Sleep problem</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input input-primary" name="familynm_15" id="fcpr_15" value="fprl_15">
                                            <label class="custom-control-label" for="fcpr_15">Snoring</label>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-12" style='margin-top: 15px;'>
                                    <p style="line-height: 1.8">Please see our mutual patient for their ENT concern and send us the report for their visit with you. We also need you send the patient back to us for oral surgery consultation.</p>
                                    <p>Sincerely,</p>
                                    <p><canvas id="sign_61fcprl1" width="480" height="80" class="col-8"></canvas>
                                        <span style="position: absolute; color: red;" class="col-auto"><a onclick="sign_61fcprl1_clear()" >Clear Signature</a></span></p>
                                    <p>Dr.<input type="text" name="familycar_12" id="familycar_12" class="col-4 dateborder" maxlength="60"></p>
                                    <p>Title<input type="text" name="familycar_13" id="familycar_13" class="col-4 dateborder" maxlength="60"></p>
                                </div>
                            </div>

                        </div>  
                    </form> 
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="buttonid" onclick="onReferral(this)">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

    function onReferral(buttonObj)
    {
        if(!$('#familycar_6').val())
           {
            msgbox("Date is Mandatory", "Patient Checklist", "error");
            return false;
           }
        $(buttonObj).attr('disabled', 'disabled');
        $(buttonObj).text('Sending...');

        $(buttonObj).off('click'); //disables click event
        var sign_61fcprl1 = window.sign_61fcprl1.toDataURL("image/png");
        var sign_61fcprl1_1 = sign_61fcprl1.replace('data:image/png;base64,', '');


        let checkboxes = document.querySelectorAll('input[name="familynm_1"]:checked');
        let values = [];
        checkboxes.forEach((checkbox) => {
            values.push(checkbox.value);
        });

        let checkboxes1 = document.querySelectorAll('input[name="familynm_2"]:checked');
        let values1 = [];
        checkboxes1.forEach((checkbox) => {
            values1.push(checkbox.value);
        });

        let checkboxes2 = document.querySelectorAll('input[name="familynm_3"]:checked');
        let values2 = [];
        checkboxes2.forEach((checkbox) => {
            values2.push(checkbox.value);
        });

        let checkboxes3 = document.querySelectorAll('input[name="familynm_4"]:checked');
        let values3 = [];
        checkboxes3.forEach((checkbox) => {
            values3.push(checkbox.value);
        });

        let checkboxes4 = document.querySelectorAll('input[name="familynm_5"]:checked');
        let values4 = [];
        checkboxes4.forEach((checkbox) => {
            values4.push(checkbox.value);
        });

        let checkboxes5 = document.querySelectorAll('input[name="familynm_6"]:checked');
        let values5 = [];
        checkboxes5.forEach((checkbox) => {
            values5.push(checkbox.value);
        });

        let checkboxes6 = document.querySelectorAll('input[name="familynm_7"]:checked');
        let values6 = [];
        checkboxes6.forEach((checkbox) => {
            values6.push(checkbox.value);
        });

        let checkboxes7 = document.querySelectorAll('input[name="familynm_8"]:checked');
        let values7 = [];
        checkboxes7.forEach((checkbox) => {
            values7.push(checkbox.value);
        });

        let checkboxes8 = document.querySelectorAll('input[name="familynm_9"]:checked');
        let values8 = [];
        checkboxes8.forEach((checkbox) => {
            values8.push(checkbox.value);
        });

        let checkboxes9 = document.querySelectorAll('input[name="familynm_10"]:checked');
        let values9 = [];
        checkboxes9.forEach((checkbox) => {
            values9.push(checkbox.value);
        });

        let checkboxes10 = document.querySelectorAll('input[name="familynm_11"]:checked');
        let values10 = [];
        checkboxes10.forEach((checkbox) => {
            values10.push(checkbox.value);
        });

        let checkboxes11 = document.querySelectorAll('input[name="familynm_12"]:checked');
        let values11 = [];
        checkboxes11.forEach((checkbox) => {
            values11.push(checkbox.value);
        });
        
        let checkboxes12 = document.querySelectorAll('input[name="familynm_13"]:checked');
        let values12 = [];
        checkboxes12.forEach((checkbox) => {
            values12.push(checkbox.value);
        });

        let checkboxes13 = document.querySelectorAll('input[name="familynm_14"]:checked');
        let values13 = [];
        checkboxes13.forEach((checkbox) => {
            values13.push(checkbox.value);
        });

        let checkboxes14 = document.querySelectorAll('input[name="familynm_15"]:checked');
        let values14 = [];
        checkboxes14.forEach((checkbox) => {
            values14.push(checkbox.value);
        });


        var referphysician = $('#familycar6_1').val();
        var officeaddress = $('#familycar_2').val();
        var citystatezip = $('#familycar_3').val();
        var license = $('#familycar_4').val();
        var indvnpi = $('#familycar_5').val();
        var currentdate = $('#familycar_6').val();
        var physician = $('#familycar_7').val();
        var patientaddress = $('#familycar_8').val();
        var patientcitystatezip = $('#familycar_9').val();
        var doctorname = $('#familycar_10').val();
        var patientname = $('#familycar_11').val();
        var patienttxt1 = $('#familycar_12').val();
        var patienttxt2 = $('#familycar_13').val();


        $.ajax({
            url: "generatereferralletterpdf",
            type: "POST", //send it through get method
            data: {
                referphysician : referphysician,
                officeaddress : officeaddress,
                patientid : $("#patientCombo option:selected").val(),
                citystatezip : citystatezip,
                license : license,
                indvnpi : indvnpi,
                currentdate : currentdate,
                lastname : $("#inputLastName").val(),
                firstname : $("#inputFirstName").val(),
                physician : physician,
                patientaddress : patientaddress,
                patientcitystatezip : patientcitystatezip,
                doctorname : doctorname,
                patientname : patientname,
                patientcheckbox1 : values,
                patientcheckbox2 : values1,
                patientcheckbox3 : values2,
                patientcheckbox4 : values3,
                patientcheckbox5 : values4,
                patientcheckbox6 : values5,
                patientcheckbox7 : values6,
                patientcheckbox8 : values7,
                patientcheckbox9 : values8,
                patientcheckbox10 : values9,
                patientcheckbox11 : values10,
                patientcheckbox12 : values11,
                patientcheckbox13 : values12,
                patientcheckbox14 : values13,
                patientcheckbox15 : values14,
                doctorsignature : sign_61fcprl1_1,
                patienttxt1 : patienttxt1,
                patienttxt2 : patienttxt2


            },
            success: function (response) {
                if (response.length > 0)
                {
                    $("#FamilyCarePhysicianReferralLette").modal('hide');
                    $('#patientCombo').trigger('change');
                }
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            },
            error: function (err) {
                console.log(err);
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            }
        });
    }


    $(document).ready(function () {
        window.sign_61fcprl1 = new SignaturePad($('#sign_61fcprl1').get(0), {});

    });
    var sign_61fcprl1_clear = function () {
        window.sign_61fcprl1.clear()
    }
</script>