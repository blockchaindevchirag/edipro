<div class="modal fade centerAligned" id="Affidavit_Intolerance_CPAP_Device" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">
                    AFFIDAVIT FOR INTOLERANCE TO CPAP DEVICE           
                </h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

            </div>
            <div class="container">
                <form id="form_affidavit">
                    <div class="card-body">  
                        <div class="col-12">
                            <p>Patient Name:<input type="text" name="affit1" id="affit1" class="data_patient_name col-6 inputborder"> 

                                Date : <input type="text" name="affit2" id="affit2" autocomplete="off" class="notfuturedate col-auto inputborder"></p>
                            <p>Practice Name:<input type="text" name="affit6" id="affit6" readonly class="col-9 dateborder data_practice_name"> </p>

                        </div>
                        <div class="row">
                            <div class="col-12">
                                <p>I have attempted to use a CPAP device to manage my sleep-related breathing disorder and find it 
                                    intolerable to use on a regular basis for the following reason(s):</p>
                            </div>

                            <div class="col-12" style="line-height: 1.8">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit1" class="custom-control-input input-primary" id="aicd_1" value="affidavitcpap">
                                    <label class="custom-control-label" for="aicd_1">Mask Leaks</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit2" class="custom-control-input input-primary" id="aicd_2"  value="affidavitcpap1">
                                    <label class="custom-control-label" for="aicd_2">Mask and/or device uncomfortable</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit3" class="custom-control-input input-primary" id="aicd_33"  value="affidavitcpap2">
                                    <label class="custom-control-label" for="aicd_33">Unable to sleep comfortable</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit4" class="custom-control-input input-primary" id="aicd44" value="affidavitcpap3">
                                    <label class="custom-control-label" for="aicd44">Noise from the device disturbs me and/or my bed partner's sleep</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit5" class="custom-control-input input-primary" id="aicd5" value="affidavitcpap4" >
                                    <label class="custom-control-label" for="aicd5">Restricts movement during sleep</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit6" class="custom-control-input input-primary" id="aicd6" value="affidavitcpap5">
                                    <label class="custom-control-label" for="aicd6">Does not seem to be effective</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit7" class="custom-control-input input-primary" id="aicd7" value="affidavitcpap6">
                                    <label class="custom-control-label" for="aicd7">Straps/headgear cause discomfort</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit8" class="custom-control-input input-primary" id="aicd8" value="affidavitcpap7" >
                                    <label class="custom-control-label" for="aicd8">Pressure on upper lip causes tooth-related problems</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit9" class="custom-control-input input-primary" id="aicd9" value="affidavitcpap8">
                                    <label class="custom-control-label" for="aicd9">Latex allergy</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit10" class="custom-control-input input-primary" id="aicd10" value="affidavitcpap9">
                                    <label class="custom-control-label" for="aicd10">Claustrophobia</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit11" class="custom-control-input input-primary" id="aicd11" value="affidavitcpap10">
                                    <label class="custom-control-label" for="aicd11">Other: <input type="text" name="affit3" id="affit3" class="col-10 dateborder" style="width: 900px;" maxlength="55"></label>
                                </div>

                            </div>

                            <div class="col-12">
                                <br/>

                                <p>I have not attempted to use a CPAP device and would prefer to use an oral appliance for the
                                    following reason(s):</p>

                            </div>

                            <div class="col-12" style="line-height: 1.8">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit12" class="custom-control-input input-primary" id="aicd12" value="affidavitcpap11">
                                    <label class="custom-control-label" for="aicd12">I'm worried that the mask, straps/headgear will cause discomfort</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit13" class="custom-control-input input-primary" id="aicd13" value="affidavitcpap12">
                                    <label class="custom-control-label" for="aicd13">I'm worried that the noise from the device will disturb me and/or my bed partner's sleep</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit14" class="custom-control-input input-primary" id="aicd14" value="affidavitcpap13">
                                    <label class="custom-control-label" for="aicd14">I'm worried that the device will restrict movement during sleep</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit15" class="custom-control-input input-primary" id="aicd15" value="affidavitcpap14" >
                                    <label class="custom-control-label" for="aicd15">I have a latex allergy</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit16" class="custom-control-input input-primary" id="aicd16" value="affidavitcpap15" >
                                    <label class="custom-control-label" for="aicd16">I suffer from claustrophobia</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit17" class="custom-control-input input-primary" id="aicd17" value="affidavitcpap16">
                                    <label class="custom-control-label" for="aicd17">I travel frequently and am worried that a CPAP device will be cumbersome to transport</label>
                                </div>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name="affidavit18" class="custom-control-input input-primary" id="aicd18" value="affidavitcpap17">
                                    <label class="custom-control-label" for="aicd18">Other: <input type="text" name="affit4" id="affit4" class="col-10 dateborder" style="width: 900px;" maxlength="55"></label>
                                </div>

                            </div>

                            <div class="col-12">

                                <p style="margin-top: 10px;">Because of my inability to use a CPAP device, I wish to have an alternative method of treatment. I 
                                    would like to try an oral appliance in an attempt to control my snoring and obstructive sleep apnea</p>

                            </div>

                            <!--==============================================================================================-->
                            <!--======================= Witness Signature======================-->
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-12">
                                        <canvas id="sign_238aicd" width="480" height="80" class="col-12">		 			
                                        </canvas>
                                    </div>
                                </div>
                                <p>Patient's Signature <span style="color: red;margin: 20px;"><a onclick="sign_238aicd_clear()">Clear Signature</a></span></p>
                            </div>
                            <div class="col-4" style="display: flex;align-items: flex-end;height: 75px; margin-bottom: 138px">
                                Date:<input type="text" name="affit5" id="affit5" autocomplete="off" class="notfuturedate col-6 dateborder"  style="padding:0">   
                            </div>


                        </div>
                    </div>     
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="affidavitcpapform_btn(this)">Submit</button>
            </div>
        </div>
    </div>
</div>
<script>


    function affidavitcpapform_btn(buttonObj)
    {
         if(!$('#affit2').val())
           {
            msgbox("Date is Mandatory", "Patient Checklist", "error");
            return false;
           }
        $(buttonObj).attr('disabled', 'disabled');
        $(buttonObj).text('Sending...');

        $(buttonObj).off('click'); //disables click event
        var sign_238aicd = window.sign_238aicd.toDataURL("image/png");
        var sign_238aicd_1 = sign_238aicd.replace('data:image/png;base64,', '');

        let checkboxes = document.querySelectorAll('input[name="affidavit1"]:checked');
        let values = [];
        checkboxes.forEach((checkbox) => {
            values.push(checkbox.value);
        });

        let checkboxes1 = document.querySelectorAll('input[name="affidavit2"]:checked');
        let values1 = [];
        checkboxes1.forEach((checkbox) => {
            values1.push(checkbox.value);
        });

        let checkboxes2 = document.querySelectorAll('input[name="affidavit3"]:checked');
        let values2 = [];
        checkboxes2.forEach((checkbox) => {
            values2.push(checkbox.value);
        });

        let checkboxes3 = document.querySelectorAll('input[name="affidavit4"]:checked');
        let values3 = [];
        checkboxes3.forEach((checkbox) => {
            values3.push(checkbox.value);
        });

        let checkboxes4 = document.querySelectorAll('input[name="affidavit5"]:checked');
        let values4 = [];
        checkboxes4.forEach((checkbox) => {
            values4.push(checkbox.value);
        });

        let checkboxes5 = document.querySelectorAll('input[name="affidavit6"]:checked');
        let values5 = [];
        checkboxes5.forEach((checkbox) => {
            values5.push(checkbox.value);
        });

        let checkboxes6 = document.querySelectorAll('input[name="affidavit7"]:checked');
        let values6 = [];
        checkboxes6.forEach((checkbox) => {
            values6.push(checkbox.value);
        });

        let checkboxes7 = document.querySelectorAll('input[name="affidavit8"]:checked');
        let values7 = [];
        checkboxes7.forEach((checkbox) => {
            values7.push(checkbox.value);
        });

        let checkboxes8 = document.querySelectorAll('input[name="affidavit9"]:checked');
        let values8 = [];
        checkboxes8.forEach((checkbox) => {
            values8.push(checkbox.value);
        });

        let checkboxes9 = document.querySelectorAll('input[name="affidavit10"]:checked');
        let values9 = [];
        checkboxes9.forEach((checkbox) => {
            values9.push(checkbox.value);
        });

        let checkboxes10 = document.querySelectorAll('input[name="affidavit11"]:checked');
        let values10 = [];
        checkboxes10.forEach((checkbox) => {
            values10.push(checkbox.value);
        });

        let checkboxes11 = document.querySelectorAll('input[name="affidavit12"]:checked');
        let values11 = [];
        checkboxes11.forEach((checkbox) => {
            values11.push(checkbox.value);
        });

        let checkboxes12 = document.querySelectorAll('input[name="affidavit13"]:checked');
        let values12 = [];
        checkboxes12.forEach((checkbox) => {
            values12.push(checkbox.value);
        });

        let checkboxes13 = document.querySelectorAll('input[name="affidavit14"]:checked');
        let values13 = [];
        checkboxes13.forEach((checkbox) => {
            values13.push(checkbox.value);
        });

        let checkboxes14 = document.querySelectorAll('input[name="affidavit15"]:checked');
        let values14 = [];
        checkboxes14.forEach((checkbox) => {
            values14.push(checkbox.value);
        });
        let checkboxes15 = document.querySelectorAll('input[name="affidavit16"]:checked');
        let values15 = [];
        checkboxes15.forEach((checkbox) => {
            values15.push(checkbox.value);
        });

        let checkboxes16 = document.querySelectorAll('input[name="affidavit17"]:checked');
        let values16 = [];
        checkboxes16.forEach((checkbox) => {
            values16.push(checkbox.value);
        });

        let checkboxes17 = document.querySelectorAll('input[name="affidavit18"]:checked');
        let values17 = [];
        checkboxes17.forEach((checkbox) => {
            values17.push(checkbox.value);
        });



        var patientname = $('#affit1').val();
        var patientcurrentdate = $('#affit2').val();
        var patienttxt1 = $('#affit3').val();
        var patienttxt2 = $('#affit4').val();
        var signdate1 = $('#affit5').val();



        $.ajax({
            url: "generateaffidavitpdf",
            type: "POST", //send it through get method
            data: {

                patientname: patientname,
                patientcurrentdate: patientcurrentdate,
                patientid: $("#patientCombo option:selected").val(),
                patienttxt1: patienttxt1,
                patientcheckbox1: values,
                patientcheckbox2: values1,
                patientcheckbox3: values2,
                patientlastname: $("#inputLastName").val(),
                patientfirstname: $("#inputFirstName").val(),
                patientcheckbox4: values3,
                patientcheckbox5: values4,
                patientcheckbox6: values5,
                patientcheckbox7: values6,
                patientcheckbox8: values7,
                patientcheckbox9: values8,
                patientcheckbox10: values9,
                patientcheckbox11: values10,
                patienttxt2: patienttxt2,
                patientcheckbox12: values11,
                patientcheckbox13: values12,
                patientcheckbox14: values13,
                patientcheckbox15: values14,
                patientcheckbox16: values15,
                patientcheckbox17: values16,
                patientcheckbox18: values17,
                patientsignature: sign_238aicd_1,
                signdate1: signdate1

            },
            success: function (response) {
                if (response.length > 0)
                {
                    $("#Affidavit_Intolerance_CPAP_Device").modal('hide');
                    $('#patientCombo').trigger('change');
                }
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            },
            error: function (err) {
                console.log(err);
                $(buttonObj).removeAttr('disabled');
                $(buttonObj).text('Submit');
            }

        });

    }

    $(document).ready(function () {
        window.sign_238aicd = new SignaturePad($('#sign_238aicd').get(0), {});

    });
    var sign_238aicd_clear = function () {
        window.sign_238aicd.clear()
    }


</script>
